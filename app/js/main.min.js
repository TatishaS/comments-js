"use strict";const form=document.querySelector(".form"),inputName=form.querySelector(".form__input--name"),inputDate=form.querySelector(".form__input--date"),inputTextarea=form.querySelector(".form__input--textarea"),formBtn=form.querySelector(".form__btn"),commentsInner=document.querySelector(".comments__inner"),nameField=document.getElementById("name-field"),textareaField=document.getElementById("textarea-field"),commentsList=document.getElementById("comments-list"),commentDate=document.querySelector(".comment__date");let comments=[];const createComment=e=>{const t=document.createElement("li");t.classList.add("comment"),t.setAttribute("id",e.id);let n="";return e||(commentsInner.innerHTML='<p style="font-style: italic">Комментариев еще нет</p>'),e&&(n=`\n  <div class="comment__wrapper">\n                    <div class="comment__header">\n                      <span class="comment__name">${e.name}</span>\n                      <span class="comment__divider"></span>\n                      <span class="comment__date">${formatDate(e.date)}</span>\n                    </div>\n                    <p class="comment__content">\n                      ${e.content}\n                    </p>\n                    <div class="comment__footer">\n                      <input\n                        type="checkbox"\n                        class="comment__like-input visually-hidden"\n                        id=like-${e.date}\n                       \n                      />\n                      <label\n                        for=like-${e.date}\n                        class="comment__like-label"\n                        aria-label="Нравится"\n                      >\n                        <svg\n                          class="comment__like-icon"\n                          xmlns="http://www.w3.org/2000/svg"\n                          height="20"\n                          width="20"\n                          viewBox="0 0 48 48"\n                        >\n                          <path\n                            d="m24 41.95-2.05-1.85q-5.3-4.85-8.75-8.375-3.45-3.525-5.5-6.3T4.825 20.4Q4 18.15 4 15.85q0-4.5 3.025-7.525Q10.05 5.3 14.5 5.3q2.85 0 5.275 1.35Q22.2 8 24 10.55q2.1-2.7 4.45-3.975T33.5 5.3q4.45 0 7.475 3.025Q44 11.35 44 15.85q0 2.3-.825 4.55T40.3 25.425q-2.05 2.775-5.5 6.3T26.05 40.1ZM24 38q5.05-4.65 8.325-7.975 3.275-3.325 5.2-5.825 1.925-2.5 2.7-4.45.775-1.95.775-3.9 0-3.3-2.1-5.425T33.5 8.3q-2.55 0-4.75 1.575T25.2 14.3h-2.45q-1.3-2.8-3.5-4.4-2.2-1.6-4.75-1.6-3.3 0-5.4 2.125Q7 12.55 7 15.85q0 1.95.775 3.925.775 1.975 2.7 4.5Q12.4 26.8 15.7 30.1 19 33.4 24 38Zm0-14.85Z"\n                          />\n                        </svg>\n                      </label>\n                      <button class="comment__delete-btn" type="submit">\n                        <img\n                          src="./images/icon-delete.svg"\n                          alt="Удалить комментарий"\n                          class="comment__delete-img"\n                          width="20"\n                          height="20"\n                        />\n                      </button>\n                    </div>\n                  </div>\n                  `),t.insertAdjacentHTML("beforeend",n),t},checkEmptyComments=()=>{if(0===comments.length){const e='<p style="font-style: italic" id="empty-comments">Комментариев еще нет</p>';commentsInner.insertAdjacentHTML("afterbegin",e)}if(comments.length>0){const e=document.querySelector("#empty-comments");e&&e.remove()}},renderComments=e=>{console.log(e),commentsList.textContent="",checkEmptyComments(),e?.sort(((e,t)=>t.date-e.date)).map((e=>{const t=createComment(e);commentsList.append(t)}))},deleteComment=e=>{if(!e.target.closest(".comment__delete-btn"))return;const t=e.target.closest(".comment"),n=+t.id;comments=comments.filter((e=>e.id!==n)),t.remove(),checkEmptyComments()},handleFormSubmit=e=>{e.preventDefault();const t=Date.now(),n=inputName.value,m=inputTextarea.value,a=inputDate.value?inputDate.valueAsNumber:Date.now();if(n||inputName.parentElement.insertAdjacentHTML("beforeend",'<span class="alert">Заполните имя</span>'),m||inputTextarea.parentElement.insertAdjacentHTML("beforeend",'<span class="alert">Заполните поля комментария</span>'),n&&m){const e={id:t,name:n,content:m,date:a};comments.push(e),renderComments(comments),clearInputs()}},dateOptions={month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},formatDate=e=>{const t=(n=new Date,m=e,Math.round(Math.abs(m-n)/864e5));var n,m;if(0===t){return`сегодня, ${new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit"}).format(e)}`}if(1===t){return`вчера, ${new Intl.DateTimeFormat("ru-RU",{hour:"2-digit",minute:"2-digit"}).format(e)}`}return new Intl.DateTimeFormat("ru-RU",dateOptions).format(e)},clearInputs=()=>{inputName.value="",inputTextarea.value="",inputDate.value=""},renderAlertMessage=(e,t)=>{let n="",m=document.createElement("span");m.classList.add("alert"),n=t,m.innerText=t,e.appendChild(m)},clearAlert=e=>{const t=e.target;t.nextElementSibling&&t.nextElementSibling.remove()};renderComments(comments),form.addEventListener("submit",(e=>handleFormSubmit(e))),document.addEventListener("keyup",(e=>{"Enter"===e.code&&handleFormSubmit(e)})),commentsList.addEventListener("click",deleteComment),inputName.addEventListener("input",(e=>clearAlert(e))),inputTextarea.addEventListener("input",(e=>clearAlert(e)));